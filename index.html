<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>darklight000999 - Dashboard</title>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet"/>
</head>
<body>
  <!-- Theme Toggle -->
  <button id="themeBtn" onclick="toggleTheme()">ğŸŒ‘ Dark</button>

  <!-- Auth Buttons (Netlify Identity Widget) -->
  <div id="auth-section">
    <button onclick="netlifyIdentity.open()">ğŸ”‘ Login / Signup</button>
    <button onclick="netlifyIdentity.logout()">ğŸšª Logout</button>
    <p id="user-info"></p>
  </div>

  <!-- Admin Dashboard -->
  <div id="adminDash" style="display:none">
    <h2>ğŸ‘‘ Admin Dashboard</h2>
    <input type="file" id="adminFile"/>
    <select id="fileCategory">
      <option value="Notes">ğŸ“˜ Notes</option>
      <option value="Assignments">ğŸ“ Assignments</option>
      <option value="Results">ğŸ“Š Results</option>
      <option value="Updates">ğŸ“¢ Updates</option>
    </select>
    <button onclick="uploadFile()">Upload</button>
    <div id="adminFileList"></div>

    <h3>ğŸ“ Create Blog</h3>
    <input id="postTitle" placeholder="Enter Title"/>
    <div id="editor" style="height:200px;background:#fff;color:#000"></div>
    <button onclick="publishPost()">Publish Post</button>
  </div>

  <!-- Student Dashboard -->
  <div id="studentDash" style="display:none">
    <h2>ğŸ“ Student Dashboard</h2>
    <div id="studentFileList"></div>
    <div id="postList"></div>
  </div>

  <!-- Quill -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <script>
    let uploadedFiles=[];
    let posts=[];
    let quill = new Quill('#editor',{theme:'snow'});
    
    // Theme
    function toggleTheme(){
      document.body.classList.toggle("light");
      document.getElementById("themeBtn").innerText=document.body.classList.contains("light")?"ğŸŒ‘ Dark":"â˜€ï¸ Light";
    }

    // File Upload
    function uploadFile(){
      const file=document.getElementById("adminFile").files[0];
      const cat=document.getElementById("fileCategory").value;
      if(!file){alert("âš ï¸ Please select a file.");return;}
      uploadedFiles.push({name:file.name,category:cat});
      renderFiles();
    }

    function renderFiles(){
      const studentList=document.getElementById("studentFileList");
      studentList.innerHTML="";
      uploadedFiles.forEach(f=>{
        studentList.innerHTML+=`<div>ğŸ“„ ${f.name} [${f.category}]</div>`;
      });
      document.getElementById("adminFileList").innerHTML=studentList.innerHTML;
    }

    // Blog
    function publishPost(){
      let title=document.getElementById("postTitle").value.trim();
      let content=quill.root.innerHTML;
      if(!title||!content){alert("âš ï¸ Title + Content required");return;}
      posts.push({title,content});
      renderPosts();
    }
    function renderPosts(){
      const postList=document.getElementById("postList");
      postList.innerHTML="";
      posts.forEach(p=>{
        postList.innerHTML+=`<div><h3>${p.title}</h3>${p.content}</div>`;
      });
    }

    // Netlify Identity Events
    netlifyIdentity.on("login", user => {
      document.getElementById("user-info").innerText="Welcome "+user.email;
      if(user.email.includes("admin")){ // simple check â†’ à¤†à¤ª Role Tagging à¤­à¥€ à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚
        document.getElementById("adminDash").style.display="block";
        document.getElementById("studentDash").style.display="none";
      }else{
        document.getElementById("studentDash").style.display="block";
        document.getElementById("adminDash").style.display="none";
      }
    });

    netlifyIdentity.on("logout", () => {
      document.getElementById("user-info").innerText="";
      document.getElementById("adminDash").style.display="none";
      document.getElementById("studentDash").style.display="none";
    });

    netlifyIdentity.init();
  </script>
</body>
</html>
